import{E as ut,V as M,M as Y,T as z,S as Ce,Q as Re,a as A,R as dt,P as mt,b as ft,c as ht,d as pt,W as yt,A as bt,D as _e,G as Ne,e as ue,f as gt,g as $,C as Et,B as wt,F as Pt,h as Tt}from"./three-BuIn8SSn.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&e(d)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();const ke={type:"change"},de={type:"start"},je={type:"end"},J=new dt,Ye=new mt,Ot=Math.cos(70*ft.DEG2RAD);class Mt extends ut{constructor(s,r){super(),this.object=s,this.domElement=r,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new M,this.cursor=new M,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Y.ROTATE,MIDDLE:Y.DOLLY,RIGHT:Y.PAN},this.touches={ONE:z.ROTATE,TWO:z.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return c.phi},this.getAzimuthalAngle=function(){return c.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",ce),this._domElementKeyEvents=t},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",ce),this._domElementKeyEvents=null},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(ke),e.update(),a=o.NONE},this.update=function(){const t=new M,n=new Re().setFromUnitVectors(s.up,new M(0,1,0)),i=n.clone().invert(),l=new M,p=new Re,N=new M,L=2*Math.PI;return function(lt=null){const Ie=e.object.position;t.copy(Ie).sub(e.target),t.applyQuaternion(n),c.setFromVector3(t),e.autoRotate&&a===o.NONE&&W(Ue(lt)),e.enableDamping?(c.theta+=y.theta*e.dampingFactor,c.phi+=y.phi*e.dampingFactor):(c.theta+=y.theta,c.phi+=y.phi);let I=e.minAzimuthAngle,C=e.maxAzimuthAngle;isFinite(I)&&isFinite(C)&&(I<-Math.PI?I+=L:I>Math.PI&&(I-=L),C<-Math.PI?C+=L:C>Math.PI&&(C-=L),I<=C?c.theta=Math.max(I,Math.min(C,c.theta)):c.theta=c.theta>(I+C)/2?Math.max(I,c.theta):Math.min(C,c.theta)),c.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,c.phi)),c.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(f,e.dampingFactor):e.target.add(f),e.target.sub(e.cursor),e.target.clampLength(e.minTargetRadius,e.maxTargetRadius),e.target.add(e.cursor),e.zoomToCursor&&v||e.object.isOrthographicCamera?c.radius=ie(c.radius):c.radius=ie(c.radius*b),t.setFromSpherical(c),t.applyQuaternion(i),Ie.copy(e.target).add(t),e.object.lookAt(e.target),e.enableDamping===!0?(y.theta*=1-e.dampingFactor,y.phi*=1-e.dampingFactor,f.multiplyScalar(1-e.dampingFactor)):(y.set(0,0,0),f.set(0,0,0));let le=!1;if(e.zoomToCursor&&v){let U=null;if(e.object.isPerspectiveCamera){const X=t.length();U=ie(X*b);const Q=X-U;e.object.position.addScaledVector(fe,Q),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const X=new M(R.x,R.y,0);X.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/b)),e.object.updateProjectionMatrix(),le=!0;const Q=new M(R.x,R.y,0);Q.unproject(e.object),e.object.position.sub(Q).add(X),e.object.updateMatrixWorld(),U=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;U!==null&&(this.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(U).add(e.object.position):(J.origin.copy(e.object.position),J.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(J.direction))<Ot?s.lookAt(e.target):(Ye.setFromNormalAndCoplanarPoint(e.object.up,e.target),J.intersectPlane(Ye,e.target))))}else e.object.isOrthographicCamera&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/b)),e.object.updateProjectionMatrix(),le=!0);return b=1,v=!1,le||l.distanceToSquared(e.object.position)>d||8*(1-p.dot(e.object.quaternion))>d||N.distanceToSquared(e.target)>0?(e.dispatchEvent(ke),l.copy(e.object.position),p.copy(e.object.quaternion),N.copy(e.target),!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",xe),e.domElement.removeEventListener("pointerdown",De),e.domElement.removeEventListener("pointercancel",F),e.domElement.removeEventListener("wheel",Le),e.domElement.removeEventListener("pointermove",re),e.domElement.removeEventListener("pointerup",F),e._domElementKeyEvents!==null&&(e._domElementKeyEvents.removeEventListener("keydown",ce),e._domElementKeyEvents=null)};const e=this,o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=o.NONE;const d=1e-6,c=new Ce,y=new Ce;let b=1;const f=new M,h=new A,D=new A,O=new A,g=new A,E=new A,x=new A,w=new A,S=new A,P=new A,fe=new M,R=new A;let v=!1;const T=[],B={};let oe=!1;function Ue(t){return t!==null?2*Math.PI/60*e.autoRotateSpeed*t:2*Math.PI/60/60*e.autoRotateSpeed}function q(t){const n=Math.abs(t*.01);return Math.pow(.95,e.zoomSpeed*n)}function W(t){y.theta-=t}function V(t){y.phi-=t}const he=function(){const t=new M;return function(i,l){t.setFromMatrixColumn(l,0),t.multiplyScalar(-i),f.add(t)}}(),pe=function(){const t=new M;return function(i,l){e.screenSpacePanning===!0?t.setFromMatrixColumn(l,1):(t.setFromMatrixColumn(l,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(i),f.add(t)}}(),k=function(){const t=new M;return function(i,l){const p=e.domElement;if(e.object.isPerspectiveCamera){const N=e.object.position;t.copy(N).sub(e.target);let L=t.length();L*=Math.tan(e.object.fov/2*Math.PI/180),he(2*i*L/p.clientHeight,e.object.matrix),pe(2*l*L/p.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(he(i*(e.object.right-e.object.left)/e.object.zoom/p.clientWidth,e.object.matrix),pe(l*(e.object.top-e.object.bottom)/e.object.zoom/p.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function ae(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?b/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function ye(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?b*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function se(t,n){if(!e.zoomToCursor)return;v=!0;const i=e.domElement.getBoundingClientRect(),l=t-i.left,p=n-i.top,N=i.width,L=i.height;R.x=l/N*2-1,R.y=-(p/L)*2+1,fe.set(R.x,R.y,1).unproject(e.object).sub(e.object.position).normalize()}function ie(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function be(t){h.set(t.clientX,t.clientY)}function Xe(t){se(t.clientX,t.clientX),w.set(t.clientX,t.clientY)}function ge(t){g.set(t.clientX,t.clientY)}function Ge(t){D.set(t.clientX,t.clientY),O.subVectors(D,h).multiplyScalar(e.rotateSpeed);const n=e.domElement;W(2*Math.PI*O.x/n.clientHeight),V(2*Math.PI*O.y/n.clientHeight),h.copy(D),e.update()}function ve(t){S.set(t.clientX,t.clientY),P.subVectors(S,w),P.y>0?ae(q(P.y)):P.y<0&&ye(q(P.y)),w.copy(S),e.update()}function Be(t){E.set(t.clientX,t.clientY),x.subVectors(E,g).multiplyScalar(e.panSpeed),k(x.x,x.y),g.copy(E),e.update()}function qe(t){se(t.clientX,t.clientY),t.deltaY<0?ye(q(t.deltaY)):t.deltaY>0&&ae(q(t.deltaY)),e.update()}function Ve(t){let n=!1;switch(t.code){case e.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?V(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):k(0,e.keyPanSpeed),n=!0;break;case e.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?V(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):k(0,-e.keyPanSpeed),n=!0;break;case e.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?W(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):k(e.keyPanSpeed,0),n=!0;break;case e.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?W(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):k(-e.keyPanSpeed,0),n=!0;break}n&&(t.preventDefault(),e.update())}function Ee(t){if(T.length===1)h.set(t.pageX,t.pageY);else{const n=j(t),i=.5*(t.pageX+n.x),l=.5*(t.pageY+n.y);h.set(i,l)}}function we(t){if(T.length===1)g.set(t.pageX,t.pageY);else{const n=j(t),i=.5*(t.pageX+n.x),l=.5*(t.pageY+n.y);g.set(i,l)}}function Pe(t){const n=j(t),i=t.pageX-n.x,l=t.pageY-n.y,p=Math.sqrt(i*i+l*l);w.set(0,p)}function Qe(t){e.enableZoom&&Pe(t),e.enablePan&&we(t)}function $e(t){e.enableZoom&&Pe(t),e.enableRotate&&Ee(t)}function Te(t){if(T.length==1)D.set(t.pageX,t.pageY);else{const i=j(t),l=.5*(t.pageX+i.x),p=.5*(t.pageY+i.y);D.set(l,p)}O.subVectors(D,h).multiplyScalar(e.rotateSpeed);const n=e.domElement;W(2*Math.PI*O.x/n.clientHeight),V(2*Math.PI*O.y/n.clientHeight),h.copy(D)}function Oe(t){if(T.length===1)E.set(t.pageX,t.pageY);else{const n=j(t),i=.5*(t.pageX+n.x),l=.5*(t.pageY+n.y);E.set(i,l)}x.subVectors(E,g).multiplyScalar(e.panSpeed),k(x.x,x.y),g.copy(E)}function Me(t){const n=j(t),i=t.pageX-n.x,l=t.pageY-n.y,p=Math.sqrt(i*i+l*l);S.set(0,p),P.set(0,Math.pow(S.y/w.y,e.zoomSpeed)),ae(P.y),w.copy(S);const N=(t.pageX+n.x)*.5,L=(t.pageY+n.y)*.5;se(N,L)}function Je(t){e.enableZoom&&Me(t),e.enablePan&&Oe(t)}function et(t){e.enableZoom&&Me(t),e.enableRotate&&Te(t)}function De(t){e.enabled!==!1&&(T.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",re),e.domElement.addEventListener("pointerup",F)),rt(t),t.pointerType==="touch"?st(t):tt(t))}function re(t){e.enabled!==!1&&(t.pointerType==="touch"?it(t):nt(t))}function F(t){ct(t),T.length===0&&(e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",re),e.domElement.removeEventListener("pointerup",F)),e.dispatchEvent(je),a=o.NONE}function tt(t){let n;switch(t.button){case 0:n=e.mouseButtons.LEFT;break;case 1:n=e.mouseButtons.MIDDLE;break;case 2:n=e.mouseButtons.RIGHT;break;default:n=-1}switch(n){case Y.DOLLY:if(e.enableZoom===!1)return;Xe(t),a=o.DOLLY;break;case Y.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;ge(t),a=o.PAN}else{if(e.enableRotate===!1)return;be(t),a=o.ROTATE}break;case Y.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;be(t),a=o.ROTATE}else{if(e.enablePan===!1)return;ge(t),a=o.PAN}break;default:a=o.NONE}a!==o.NONE&&e.dispatchEvent(de)}function nt(t){switch(a){case o.ROTATE:if(e.enableRotate===!1)return;Ge(t);break;case o.DOLLY:if(e.enableZoom===!1)return;ve(t);break;case o.PAN:if(e.enablePan===!1)return;Be(t);break}}function Le(t){e.enabled===!1||e.enableZoom===!1||a!==o.NONE||(t.preventDefault(),e.dispatchEvent(de),qe(ot(t)),e.dispatchEvent(je))}function ot(t){const n=t.deltaMode,i={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(n){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return t.ctrlKey&&!oe&&(i.deltaY*=10),i}function at(t){t.key==="Control"&&(oe=!0,document.addEventListener("keyup",Ae,{passive:!0,capture:!0}))}function Ae(t){t.key==="Control"&&(oe=!1,document.removeEventListener("keyup",Ae,{passive:!0,capture:!0}))}function ce(t){e.enabled===!1||e.enablePan===!1||Ve(t)}function st(t){switch(Se(t),T.length){case 1:switch(e.touches.ONE){case z.ROTATE:if(e.enableRotate===!1)return;Ee(t),a=o.TOUCH_ROTATE;break;case z.PAN:if(e.enablePan===!1)return;we(t),a=o.TOUCH_PAN;break;default:a=o.NONE}break;case 2:switch(e.touches.TWO){case z.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;Qe(t),a=o.TOUCH_DOLLY_PAN;break;case z.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;$e(t),a=o.TOUCH_DOLLY_ROTATE;break;default:a=o.NONE}break;default:a=o.NONE}a!==o.NONE&&e.dispatchEvent(de)}function it(t){switch(Se(t),a){case o.TOUCH_ROTATE:if(e.enableRotate===!1)return;Te(t),e.update();break;case o.TOUCH_PAN:if(e.enablePan===!1)return;Oe(t),e.update();break;case o.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;Je(t),e.update();break;case o.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;et(t),e.update();break;default:a=o.NONE}}function xe(t){e.enabled!==!1&&t.preventDefault()}function rt(t){T.push(t.pointerId)}function ct(t){delete B[t.pointerId];for(let n=0;n<T.length;n++)if(T[n]==t.pointerId){T.splice(n,1);return}}function Se(t){let n=B[t.pointerId];n===void 0&&(n=new A,B[t.pointerId]=n),n.set(t.pageX,t.pageY)}function j(t){const n=t.pointerId===T[0]?T[1]:T[0];return B[n]}e.domElement.addEventListener("contextmenu",xe),e.domElement.addEventListener("pointerdown",De),e.domElement.addEventListener("pointercancel",F),e.domElement.addEventListener("wheel",Le,{passive:!1}),document.addEventListener("keydown",at,{passive:!0,capture:!0}),this.update()}}const _=new ht;_.background=null;const G=new pt(75,window.innerWidth/window.innerHeight,.1,1e3),K=new yt({antialias:!0,alpha:!0});K.setSize(window.innerWidth,window.innerHeight);K.setClearColor(0,0);document.body.appendChild(K.domElement);const Z=new Mt(G,K.domElement);Z.enableDamping=!0;Z.dampingFactor=.05;Z.enablePan=!0;Z.enableZoom=!0;Z.enableRotate=!0;G.position.z=30;const m={turns:6,basePairsPerTurn:10,radius:6,ribbonWidth:2,basePairWidth:.4,basePairLength:6,height:100,helixOffset:Math.PI},ee={A:16724787,T:3407667,C:3355647,G:16755200},Ke=[],Dt=["A","T","C","G"],te=m.turns*m.basePairsPerTurn;for(let u=0;u<te;u++){const s=Dt[Math.floor(Math.random()*4)];Ke.push(s)}function Lt(){const u=new Ne;function s(d=!1){const c=[],y=[],b=te*8;for(let h=0;h<=b;h++){const D=h/b,O=-D*Math.PI*2*m.turns+(d?m.helixOffset:0),g=D*m.height-m.height/2,E=Math.cos(O)*m.radius,x=Math.sin(O)*m.radius,w=Math.sin(O),S=-Math.cos(O);if(c.push(E-w*m.ribbonWidth*.5,g,x-S*m.ribbonWidth*.5,E+w*m.ribbonWidth*.5,g,x+S*m.ribbonWidth*.5),h<b){const P=h*2;y.push(P,P+1,P+2,P+1,P+3,P+2)}}const f=new wt;return f.setAttribute("position",new Pt(c,3)),f.setIndex(y),f.computeVertexNormals(),f}const r=new ue({color:14540253,shininess:100,specular:16777215,side:gt}),e=new $(s(!1),r),o=new $(s(!0),r);u.add(e),u.add(o);const a=new Et(m.basePairWidth/2,m.basePairWidth/2,m.basePairLength,24,1,!1);a.rotateZ(Math.PI/2);for(let d=0;d<te;d++){const c=d/te,y=c*Math.PI*2*m.turns,b=c*m.height-m.height/2,f=Ke[d],h=f==="A"?"T":f==="T"?"A":f==="C"?"G":"C",D=new ue({color:ee[f],shininess:30,specular:2236962,emissive:ee[f],emissiveIntensity:.2}),O=new ue({color:ee[h],shininess:30,specular:2236962,emissive:ee[h],emissiveIntensity:.2}),g=new $(a,D),E=new $(a,O),x=m.basePairLength/2;g.position.set(-3,b,0),E.position.set(x,b,0);const w=new Ne;w.add(g),w.add(E),w.rotation.y=y,g.userData={type:f},E.userData={type:h},u.add(w)}return u}const At=new bt(4210752);_.add(At);const Ze=new _e(16777215,1);Ze.position.set(1,1,1);_.add(Ze);const We=new _e(16777215,.5);We.position.set(-1,-1,-1);_.add(We);const H=Lt();_.add(H);const ze=.8,He=500,me=500,ne=new Map;function xt(){H.traverse(u=>{u.userData&&u.userData.type&&u.material&&(u.material.emissiveIntensity=0,delete u.userData.fadeOutStartTime,delete u.userData.fadeOutStartIntensity)}),ne.clear()}window.addEventListener("message",u=>{if(u.data.type==="hover"){const s=u.data.base;if(s){xt(),St(s).forEach(d=>{ne.set(d,performance.now())}),document.querySelectorAll(".base-pair span").forEach(d=>{d.classList.remove("highlighted"),d.style.transform="",d.style.textShadow=""});const e=s==="A"?"T":s==="T"?"A":s==="C"?"G":"C",o=document.querySelector(`.${s.toLowerCase()}`),a=document.querySelector(`.${e.toLowerCase()}`);o&&o.classList.add("highlighted"),a&&setTimeout(()=>{a.classList.add("highlighted")},150),window.parent.postMessage({type:"baseHighlighted",base:s},"*")}}else if(u.data.type==="clearHighlight"){const s=performance.now();H.traverse(r=>{r.userData&&r.userData.type&&r.material&&r.material.emissiveIntensity>0&&(r.userData.fadeOutStartIntensity=r.material.emissiveIntensity,r.userData.fadeOutStartTime=s)}),ne.clear(),document.querySelectorAll(".base-pair span").forEach(r=>{r.classList.remove("highlighted")})}});function St(u){const s=[];return H.traverse(r=>{r.userData&&r.userData.type===u&&s.push(r)}),s}new Tt;new A;window.addEventListener("resize",()=>{G.aspect=window.innerWidth/window.innerHeight,G.updateProjectionMatrix(),K.setSize(window.innerWidth,window.innerHeight)});function Fe(){requestAnimationFrame(Fe);const u=performance.now();ne.forEach((s,r)=>{const e=u-s;if(e<He){const o=e/He*ze;r.material.emissiveIntensity=o}else r.material.emissiveIntensity=ze}),H.traverse(s=>{if(s.userData&&s.userData.fadeOutStartTime){const r=u-s.userData.fadeOutStartTime;if(r<me){const e=(me-r)/me*s.userData.fadeOutStartIntensity;s.material.emissiveIntensity=e}else s.material.emissiveIntensity=0,delete s.userData.fadeOutStartTime,delete s.userData.fadeOutStartIntensity}}),H.rotation.y+=.001,Z.update(),K.render(_,G)}Fe();
